<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>libshardcache: src/shardcache.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libshardcache
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('shardcache_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">shardcache.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>shardcache C implementation  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;stdint.h&gt;</code><br/>
<code>#include &lt;stdarg.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &lt;sys/time.h&gt;</code><br/>
<code>#include &lt;syslog.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="shardcache__log_8h_source.html">shardcache_log.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="shardcache__storage_8h_source.html">shardcache_storage.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="shardcache__node_8h_source.html">shardcache_node.h</a>&gt;</code><br/>
</div>
<p><a href="shardcache_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a2acb8d72a99ea98491e67ec0031c7046"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a2acb8d72a99ea98491e67ec0031c7046">SHARDCACHE_PORT_DEFAULT</a>&#160;&#160;&#160;4444</td></tr>
<tr class="separator:a2acb8d72a99ea98491e67ec0031c7046"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d5fe7f7e7f330d07a614c15d8259bd8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a9d5fe7f7e7f330d07a614c15d8259bd8">SHARDCACHE_TCP_TIMEOUT_DEFAULT</a>&#160;&#160;&#160;5000</td></tr>
<tr class="separator:a9d5fe7f7e7f330d07a614c15d8259bd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0691be19b2b42d7c57ab709ffb6a179e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a0691be19b2b42d7c57ab709ffb6a179e">SHARDCACHE_EXPIRE_TIME_DEFAULT</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a0691be19b2b42d7c57ab709ffb6a179e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22a3e8858304cad081b2f68a1b226ab0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a22a3e8858304cad081b2f68a1b226ab0">SHARDCACHE_IOMUX_RUN_TIMEOUT_LOW</a>&#160;&#160;&#160;100000</td></tr>
<tr class="separator:a22a3e8858304cad081b2f68a1b226ab0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f18275ed9bdb13b5b7fd7aefaa1e29d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a0f18275ed9bdb13b5b7fd7aefaa1e29d">SHARDCACHE_IOMUX_RUN_TIMEOUT_HIGH</a>&#160;&#160;&#160;500000</td></tr>
<tr class="separator:a0f18275ed9bdb13b5b7fd7aefaa1e29d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43188213899813e2abb0a7c3710f374b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a43188213899813e2abb0a7c3710f374b">SHARDCACHE_CONNECTION_EXPIRE_DEFAULT</a>&#160;&#160;&#160;5000</td></tr>
<tr class="separator:a43188213899813e2abb0a7c3710f374b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8cbc81ee9446683bb0c6b13da7a4fb5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#ae8cbc81ee9446683bb0c6b13da7a4fb5">SHARDCACHE_SERVING_LOOK_AHEAD_DEFAULT</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:ae8cbc81ee9446683bb0c6b13da7a4fb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa40f71288aa826fe0f8394061023bce1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#aa40f71288aa826fe0f8394061023bce1">SHARDCACHE_ASYNC_THREADS_NUM_DEFAULT</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:aa40f71288aa826fe0f8394061023bce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a3acf120b7116e8d820fc897eebc08db2"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a3acf120b7116e8d820fc897eebc08db2">shardcache_get_async_callback_t</a> )(void *key, size_t klen, void *data, size_t dlen, size_t total_size, struct timeval *timestamp, void *priv)</td></tr>
<tr class="memdesc:a3acf120b7116e8d820fc897eebc08db2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback passed to <a class="el" href="shardcache_8h.html#ae87bbf3da1b1a4b80f8c6213abc320ac" title="Get the value for a key asynchronously.">shardcache_get_async()</a> to receive the data asynchronously.  <a href="#a3acf120b7116e8d820fc897eebc08db2">More...</a><br/></td></tr>
<tr class="separator:a3acf120b7116e8d820fc897eebc08db2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c1c0f4fc9fde145696010fefaaee4c1"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a6c1c0f4fc9fde145696010fefaaee4c1">shardcache_async_response_callback_t</a> )(void *key, size_t klen, int res, void *priv)</td></tr>
<tr class="memdesc:a6c1c0f4fc9fde145696010fefaaee4c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback expected by all the _async() routines returning an integer result (basically all apart <a class="el" href="shardcache_8h.html#ae87bbf3da1b1a4b80f8c6213abc320ac" title="Get the value for a key asynchronously.">shardcache_get_async()</a> shardcache_offset_async())  <a href="#a6c1c0f4fc9fde145696010fefaaee4c1">More...</a><br/></td></tr>
<tr class="separator:a6c1c0f4fc9fde145696010fefaaee4c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aff07062e3204d6cf55d96a68ceed3898"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_3global_scope_4.html#structshardcache__storage__t">shardcache_storage_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#aff07062e3204d6cf55d96a68ceed3898">shardcache_storage_load</a> (char *filename, char **options)</td></tr>
<tr class="separator:aff07062e3204d6cf55d96a68ceed3898"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a006cbd2785de669bc2182938932c42e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a006cbd2785de669bc2182938932c42e2">shardcache_storage_dispose</a> (<a class="el" href="namespace_3global_scope_4.html#structshardcache__storage__t">shardcache_storage_t</a> *st)</td></tr>
<tr class="separator:a006cbd2785de669bc2182938932c42e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a094cb6df8cdae92d15b4ff3944fcc4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a6a094cb6df8cdae92d15b4ff3944fcc4">shardcache_storage_reset</a> (<a class="el" href="namespace_3global_scope_4.html#structshardcache__storage__t">shardcache_storage_t</a> *st)</td></tr>
<tr class="separator:a6a094cb6df8cdae92d15b4ff3944fcc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74346747eb9ad9da22cd1c6b06849d3e"><td class="memItemLeft" align="right" valign="top">shardcache_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a74346747eb9ad9da22cd1c6b06849d3e">shardcache_create</a> (char *me, <a class="el" href="shardcache__node_8h.html#a860894af5414a0540d590e28afe950c7">shardcache_node_t</a> **nodes, int num_nodes, <a class="el" href="namespace_3global_scope_4.html#structshardcache__storage__t">shardcache_storage_t</a> *storage, char *secret, int num_workers, int num_async, size_t cache_size)</td></tr>
<tr class="memdesc:a74346747eb9ad9da22cd1c6b06849d3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new shardcache instance.  <a href="#a74346747eb9ad9da22cd1c6b06849d3e">More...</a><br/></td></tr>
<tr class="separator:a74346747eb9ad9da22cd1c6b06849d3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c6344be0358998e1ba9809ba4f3fd4e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a0c6344be0358998e1ba9809ba4f3fd4e">shardcache_use_persistent_connections</a> (shardcache_t *cache, int new_value)</td></tr>
<tr class="separator:a0c6344be0358998e1ba9809ba4f3fd4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af443e10682cbc1755ed4514d8a5708ba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#af443e10682cbc1755ed4514d8a5708ba">shardcache_evict_on_delete</a> (shardcache_t *cache, int new_value)</td></tr>
<tr class="separator:af443e10682cbc1755ed4514d8a5708ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a450f19437f06b05ff8db556017d38394"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a450f19437f06b05ff8db556017d38394">shardcache_force_caching</a> (shardcache_t *cache, int new_value)</td></tr>
<tr class="separator:a450f19437f06b05ff8db556017d38394"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dfc8da5ca7b0d2ea2947db9b731a1fb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a4dfc8da5ca7b0d2ea2947db9b731a1fb">shardcache_tcp_timeout</a> (shardcache_t *cache, int new_value)</td></tr>
<tr class="separator:a4dfc8da5ca7b0d2ea2947db9b731a1fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab37e1067d136856d61a75ba3b32d6516"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#ab37e1067d136856d61a75ba3b32d6516">shardcache_conn_expire_time</a> (shardcache_t *cache, int new_value)</td></tr>
<tr class="separator:ab37e1067d136856d61a75ba3b32d6516"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac73a0c6f12b5b5f0c035967cdcf82727"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#ac73a0c6f12b5b5f0c035967cdcf82727">shardcache_iomux_run_timeout_low</a> (shardcache_t *cache, int new_value)</td></tr>
<tr class="separator:ac73a0c6f12b5b5f0c035967cdcf82727"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32e1cc626c927a974cd574d98a3a9124"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a32e1cc626c927a974cd574d98a3a9124">shardcache_iomux_run_timeout_high</a> (shardcache_t *cache, int new_value)</td></tr>
<tr class="separator:a32e1cc626c927a974cd574d98a3a9124"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad47c6ef316980ae82605b303c87e3c4d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#ad47c6ef316980ae82605b303c87e3c4d">shardcache_expire_time</a> (shardcache_t *cache, int new_value)</td></tr>
<tr class="separator:ad47c6ef316980ae82605b303c87e3c4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad3a553d54123b731207f95791f0022e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#aad3a553d54123b731207f95791f0022e">shardcache_serving_look_ahead</a> (shardcache_t *cache, int new_value)</td></tr>
<tr class="separator:aad3a553d54123b731207f95791f0022e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58997a3ef53dd994a9c495ff70a4e270"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a58997a3ef53dd994a9c495ff70a4e270">shardcache_lazy_expiration</a> (shardcache_t *cache, int new_value)</td></tr>
<tr class="separator:a58997a3ef53dd994a9c495ff70a4e270"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25fc04bda4021be45e33cbcf4590e849"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a25fc04bda4021be45e33cbcf4590e849">shardcache_destroy</a> (shardcache_t *cache)</td></tr>
<tr class="memdesc:a25fc04bda4021be45e33cbcf4590e849"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release all the resources used by the shardcache instance.  <a href="#a25fc04bda4021be45e33cbcf4590e849">More...</a><br/></td></tr>
<tr class="separator:a25fc04bda4021be45e33cbcf4590e849"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add7d8054738f5061aeb051b827596519"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#add7d8054738f5061aeb051b827596519">shardcache_get</a> (shardcache_t *cache, void *key, size_t klen, size_t *vlen, struct timeval *timestamp)</td></tr>
<tr class="memdesc:add7d8054738f5061aeb051b827596519"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the value for a key.  <a href="#add7d8054738f5061aeb051b827596519">More...</a><br/></td></tr>
<tr class="separator:add7d8054738f5061aeb051b827596519"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a871f29a62beca074def85a144d359ec2"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a871f29a62beca074def85a144d359ec2">shardcache_head</a> (shardcache_t *cache, void *key, size_t klen, void *head, size_t hlen, struct timeval *timestamp)</td></tr>
<tr class="memdesc:a871f29a62beca074def85a144d359ec2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get partial value data value for a key.  <a href="#a871f29a62beca074def85a144d359ec2">More...</a><br/></td></tr>
<tr class="separator:a871f29a62beca074def85a144d359ec2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca9675ed9f8be9512d7e6151783168ed"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#aca9675ed9f8be9512d7e6151783168ed">shardcache_get_offset</a> (shardcache_t *cache, void *key, size_t klen, void *out, size_t *olen, size_t offset, struct timeval *timestamp)</td></tr>
<tr class="memdesc:aca9675ed9f8be9512d7e6151783168ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get partial value data value for a key.  <a href="#aca9675ed9f8be9512d7e6151783168ed">More...</a><br/></td></tr>
<tr class="separator:aca9675ed9f8be9512d7e6151783168ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae87bbf3da1b1a4b80f8c6213abc320ac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#ae87bbf3da1b1a4b80f8c6213abc320ac">shardcache_get_async</a> (shardcache_t *cache, void *key, size_t klen, <a class="el" href="shardcache_8h.html#a3acf120b7116e8d820fc897eebc08db2">shardcache_get_async_callback_t</a> cb, void *priv)</td></tr>
<tr class="memdesc:ae87bbf3da1b1a4b80f8c6213abc320ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the value for a key asynchronously.  <a href="#ae87bbf3da1b1a4b80f8c6213abc320ac">More...</a><br/></td></tr>
<tr class="separator:ae87bbf3da1b1a4b80f8c6213abc320ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41dee186c3b877f32386da245bcc6a7e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a41dee186c3b877f32386da245bcc6a7e">shardcache_get_offset_async</a> (shardcache_t *cache, void *key, size_t klen, size_t offset, size_t length, <a class="el" href="shardcache_8h.html#a3acf120b7116e8d820fc897eebc08db2">shardcache_get_async_callback_t</a> cb, void *priv)</td></tr>
<tr class="memdesc:a41dee186c3b877f32386da245bcc6a7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get partial value data value for a key asynchronously.  <a href="#a41dee186c3b877f32386da245bcc6a7e">More...</a><br/></td></tr>
<tr class="separator:a41dee186c3b877f32386da245bcc6a7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9eb52ab9f65460bdc4958eaefb0b2954"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a9eb52ab9f65460bdc4958eaefb0b2954">shardcache_exists_async</a> (shardcache_t *cache, void *key, size_t klen, <a class="el" href="shardcache_8h.html#a6c1c0f4fc9fde145696010fefaaee4c1">shardcache_async_response_callback_t</a> cb, void *priv)</td></tr>
<tr class="memdesc:a9eb52ab9f65460bdc4958eaefb0b2954"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if a specific key exists on the node responsible for it.  <a href="#a9eb52ab9f65460bdc4958eaefb0b2954">More...</a><br/></td></tr>
<tr class="separator:a9eb52ab9f65460bdc4958eaefb0b2954"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55b425016e88f20934e14e338f795397"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a55b425016e88f20934e14e338f795397">shardcache_touch</a> (shardcache_t *cache, void *key, size_t klen)</td></tr>
<tr class="memdesc:a55b425016e88f20934e14e338f795397"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a key into the cache if not present already, otherwise update the loaded-timestamp.  <a href="#a55b425016e88f20934e14e338f795397">More...</a><br/></td></tr>
<tr class="separator:a55b425016e88f20934e14e338f795397"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a671f35e550582e8e33f4d66ca03adc57"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a671f35e550582e8e33f4d66ca03adc57">shardcache_set</a> (shardcache_t *cache, void *key, size_t klen, void *value, size_t vlen)</td></tr>
<tr class="memdesc:a671f35e550582e8e33f4d66ca03adc57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the value for a key.  <a href="#a671f35e550582e8e33f4d66ca03adc57">More...</a><br/></td></tr>
<tr class="separator:a671f35e550582e8e33f4d66ca03adc57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b16b6d50d4e163e92c44025f38ce581"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a7b16b6d50d4e163e92c44025f38ce581">shardcache_set_async</a> (shardcache_t *cache, void *key, size_t klen, void *value, size_t vlen, time_t expire, int if_not_exists, <a class="el" href="shardcache_8h.html#a6c1c0f4fc9fde145696010fefaaee4c1">shardcache_async_response_callback_t</a> cb, void *priv)</td></tr>
<tr class="memdesc:a7b16b6d50d4e163e92c44025f38ce581"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the value for a key fetching the response asyncrhonously.  <a href="#a7b16b6d50d4e163e92c44025f38ce581">More...</a><br/></td></tr>
<tr class="separator:a7b16b6d50d4e163e92c44025f38ce581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95760527edef026e88565106effe88b0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a95760527edef026e88565106effe88b0">shardcache_add</a> (shardcache_t *cache, void *key, size_t klen, void *value, size_t vlen)</td></tr>
<tr class="memdesc:a95760527edef026e88565106effe88b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the value for a key if it doesn't already exist.  <a href="#a95760527edef026e88565106effe88b0">More...</a><br/></td></tr>
<tr class="separator:a95760527edef026e88565106effe88b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aa7a564fbe7884299d77eca29432319"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a2aa7a564fbe7884299d77eca29432319">shardcache_set_volatile</a> (shardcache_t *cache, void *key, size_t klen, void *value, size_t vlen, time_t expire)</td></tr>
<tr class="memdesc:a2aa7a564fbe7884299d77eca29432319"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a volatile value for a key.  <a href="#a2aa7a564fbe7884299d77eca29432319">More...</a><br/></td></tr>
<tr class="separator:a2aa7a564fbe7884299d77eca29432319"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7c9051ef937c4b4ae02b0017d513274"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#aa7c9051ef937c4b4ae02b0017d513274">shardcache_add_volatile</a> (shardcache_t *cache, void *key, size_t klen, void *value, size_t vlen, time_t expire)</td></tr>
<tr class="memdesc:aa7c9051ef937c4b4ae02b0017d513274"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the volatile value for a key if it doesn't already exist.  <a href="#aa7c9051ef937c4b4ae02b0017d513274">More...</a><br/></td></tr>
<tr class="separator:aa7c9051ef937c4b4ae02b0017d513274"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af859541766d97b6afb992ef1c843711a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#af859541766d97b6afb992ef1c843711a">shardcache_del</a> (shardcache_t *cache, void *key, size_t klen)</td></tr>
<tr class="memdesc:af859541766d97b6afb992ef1c843711a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove the value for a key.  <a href="#af859541766d97b6afb992ef1c843711a">More...</a><br/></td></tr>
<tr class="separator:af859541766d97b6afb992ef1c843711a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49754acc649df6ffb5a997ddb924968d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a49754acc649df6ffb5a997ddb924968d">shardcache_del_async</a> (shardcache_t *cache, void *key, size_t klen, <a class="el" href="shardcache_8h.html#a6c1c0f4fc9fde145696010fefaaee4c1">shardcache_async_response_callback_t</a> cb, void *priv)</td></tr>
<tr class="memdesc:a49754acc649df6ffb5a997ddb924968d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove the value for a key asynchronously.  <a href="#a49754acc649df6ffb5a997ddb924968d">More...</a><br/></td></tr>
<tr class="separator:a49754acc649df6ffb5a997ddb924968d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3630c66ba810d5dad9bfbc2492f6cce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#af3630c66ba810d5dad9bfbc2492f6cce">shardcache_evict</a> (shardcache_t *cache, void *key, size_t klen)</td></tr>
<tr class="memdesc:af3630c66ba810d5dad9bfbc2492f6cce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove the value from the cache for a key.  <a href="#af3630c66ba810d5dad9bfbc2492f6cce">More...</a><br/></td></tr>
<tr class="separator:af3630c66ba810d5dad9bfbc2492f6cce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cac3c97e156092f9d560f54d37df98d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a7cac3c97e156092f9d560f54d37df98d">shardcache_test_ownership</a> (shardcache_t *cache, void *key, size_t klen, char *owner, size_t *len)</td></tr>
<tr class="memdesc:a7cac3c97e156092f9d560f54d37df98d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the node owning a specific key.  <a href="#a7cac3c97e156092f9d560f54d37df98d">More...</a><br/></td></tr>
<tr class="separator:a7cac3c97e156092f9d560f54d37df98d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d02396238920c93777e1eb2bc83dad0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="shardcache__storage_8h.html#structshardcache__storage__index__t">shardcache_storage_index_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a9d02396238920c93777e1eb2bc83dad0">shardcache_get_index</a> (shardcache_t *cache)</td></tr>
<tr class="memdesc:a9d02396238920c93777e1eb2bc83dad0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the index of keys managed by the specific shardcache instance by querying the storage module.  <a href="#a9d02396238920c93777e1eb2bc83dad0">More...</a><br/></td></tr>
<tr class="separator:a9d02396238920c93777e1eb2bc83dad0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f3e042fe58a3dd7537c81de115bba25"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a7f3e042fe58a3dd7537c81de115bba25">shardcache_free_index</a> (<a class="el" href="shardcache__storage_8h.html#structshardcache__storage__index__t">shardcache_storage_index_t</a> *index)</td></tr>
<tr class="memdesc:a7f3e042fe58a3dd7537c81de115bba25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release all resources used by the index provided as argument.  <a href="#a7f3e042fe58a3dd7537c81de115bba25">More...</a><br/></td></tr>
<tr class="separator:a7f3e042fe58a3dd7537c81de115bba25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9e3022be060e7b5e67af43c682632ac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#ab9e3022be060e7b5e67af43c682632ac">shardcache_migration_begin</a> (shardcache_t *cache, <a class="el" href="shardcache__node_8h.html#a860894af5414a0540d590e28afe950c7">shardcache_node_t</a> **nodes, int num_nodes, int forward)</td></tr>
<tr class="memdesc:ab9e3022be060e7b5e67af43c682632ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start a migration process.  <a href="#ab9e3022be060e7b5e67af43c682632ac">More...</a><br/></td></tr>
<tr class="separator:ab9e3022be060e7b5e67af43c682632ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a719c3343ec7ac158d71d6f286da5fec9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a719c3343ec7ac158d71d6f286da5fec9">shardcache_migration_abort</a> (shardcache_t *cache)</td></tr>
<tr class="memdesc:a719c3343ec7ac158d71d6f286da5fec9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort the current migration process.  <a href="#a719c3343ec7ac158d71d6f286da5fec9">More...</a><br/></td></tr>
<tr class="separator:a719c3343ec7ac158d71d6f286da5fec9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a767a80d75a850f38c60c298cffe180fd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a767a80d75a850f38c60c298cffe180fd">shardcache_migration_end</a> (shardcache_t *cache)</td></tr>
<tr class="memdesc:a767a80d75a850f38c60c298cffe180fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">End the current migration process by swapping the two continua and releasing resources for the old one.  <a href="#a767a80d75a850f38c60c298cffe180fd">More...</a><br/></td></tr>
<tr class="separator:a767a80d75a850f38c60c298cffe180fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36c2f67d3e4dd28ba7d932b022e39985"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a36c2f67d3e4dd28ba7d932b022e39985">shardcache_thread_init</a> (shardcache_t *cache)</td></tr>
<tr class="memdesc:a36c2f67d3e4dd28ba7d932b022e39985"><td class="mdescLeft">&#160;</td><td class="mdescRight">Notify the internal shardcache core about a new woerker thread which might access the API. This function must be called early within each user-created thread (which is intended to access the shardcache API at some stage during its lifespan) to initialize thread-specific variables.  <a href="#a36c2f67d3e4dd28ba7d932b022e39985">More...</a><br/></td></tr>
<tr class="separator:a36c2f67d3e4dd28ba7d932b022e39985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf5bf17736aec39c86103020721c12cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#abf5bf17736aec39c86103020721c12cc">shardcache_thread_end</a> (shardcache_t *cache)</td></tr>
<tr class="memdesc:abf5bf17736aec39c86103020721c12cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release the resources allocated by <a class="el" href="shardcache_8h.html#a36c2f67d3e4dd28ba7d932b022e39985" title="Notify the internal shardcache core about a new woerker thread which might access the API...">shardcache_thread_init()</a> This function needs to be called before calling pthread_exit() to free memory allocated by <a class="el" href="shardcache_8h.html#a36c2f67d3e4dd28ba7d932b022e39985" title="Notify the internal shardcache core about a new woerker thread which might access the API...">shardcache_thread_init()</a>.  <a href="#abf5bf17736aec39c86103020721c12cc">More...</a><br/></td></tr>
<tr class="separator:abf5bf17736aec39c86103020721c12cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a212ce745de022f9dab442d5232cc1809"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="shardcache_8h.html#a212ce745de022f9dab442d5232cc1809">LIBSHARDCACHE_VERSION</a></td></tr>
<tr class="separator:a212ce745de022f9dab442d5232cc1809"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>shardcache C implementation </p>
<dl class="section author"><dt>Author</dt><dd>Andrea Guzzo </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a2acb8d72a99ea98491e67ec0031c7046"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHARDCACHE_PORT_DEFAULT&#160;&#160;&#160;4444</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a9d5fe7f7e7f330d07a614c15d8259bd8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHARDCACHE_TCP_TIMEOUT_DEFAULT&#160;&#160;&#160;5000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0691be19b2b42d7c57ab709ffb6a179e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHARDCACHE_EXPIRE_TIME_DEFAULT&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a22a3e8858304cad081b2f68a1b226ab0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHARDCACHE_IOMUX_RUN_TIMEOUT_LOW&#160;&#160;&#160;100000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0f18275ed9bdb13b5b7fd7aefaa1e29d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHARDCACHE_IOMUX_RUN_TIMEOUT_HIGH&#160;&#160;&#160;500000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a43188213899813e2abb0a7c3710f374b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHARDCACHE_CONNECTION_EXPIRE_DEFAULT&#160;&#160;&#160;5000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae8cbc81ee9446683bb0c6b13da7a4fb5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHARDCACHE_SERVING_LOOK_AHEAD_DEFAULT&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa40f71288aa826fe0f8394061023bce1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHARDCACHE_ASYNC_THREADS_NUM_DEFAULT&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a3acf120b7116e8d820fc897eebc08db2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* shardcache_get_async_callback_t)(void *key, size_t klen, void *data, size_t dlen, size_t total_size, struct timeval *timestamp, void *priv)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback passed to <a class="el" href="shardcache_8h.html#ae87bbf3da1b1a4b80f8c6213abc320ac" title="Get the value for a key asynchronously.">shardcache_get_async()</a> to receive the data asynchronously. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">data</td><td>The pointer to the chunk of data </td></tr>
    <tr><td class="paramname">dlen</td><td>The length of the current chunk of data </td></tr>
    <tr><td class="paramname">total_size</td><td>If non zero, it indicates that this is the last chunk and tells total size of the data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>this argument is set only when the data is completed and we know its real total size. The callback will not be called anymore once this parameter has been provided </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timestamp</td><td>If not NULL, it indicates that this is the last chunk and points to the timeval holding the timestamp of when the data has been loaded into the cache </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>this argument is set only when the data is completed and we know it has been completely loaded into the cache. The callback will not be called anymore once this parameter has been provided </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">priv</td><td>The priv pointer passed to <a class="el" href="shardcache_8h.html#ae87bbf3da1b1a4b80f8c6213abc320ac" title="Get the value for a key asynchronously.">shardcache_get_async()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if no errors occurred and more data can be provided safely;<br/>
 -1 if an error occurs and we don't want the callback to be called again (which could eventually abort the fetch operation) </dd></dl>

</div>
</div>
<a class="anchor" id="a6c1c0f4fc9fde145696010fefaaee4c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* shardcache_async_response_callback_t)(void *key, size_t klen, int res, void *priv)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback expected by all the _async() routines returning an integer result (basically all apart <a class="el" href="shardcache_8h.html#ae87bbf3da1b1a4b80f8c6213abc320ac" title="Get the value for a key asynchronously.">shardcache_get_async()</a> shardcache_offset_async()) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>A valid pointer to the key of the command this response refers to </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">res</td><td>The integer response returned from the issued command </td></tr>
    <tr><td class="paramname">priv</td><td>The 'priv' pointer previously passed to the _async() function </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aff07062e3204d6cf55d96a68ceed3898"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_3global_scope_4.html#structshardcache__storage__t">shardcache_storage_t</a>* shardcache_storage_load </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a006cbd2785de669bc2182938932c42e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void shardcache_storage_dispose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespace_3global_scope_4.html#structshardcache__storage__t">shardcache_storage_t</a> *&#160;</td>
          <td class="paramname"><em>st</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a6a094cb6df8cdae92d15b4ff3944fcc4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_storage_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespace_3global_scope_4.html#structshardcache__storage__t">shardcache_storage_t</a> *&#160;</td>
          <td class="paramname"><em>st</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a74346747eb9ad9da22cd1c6b06849d3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">shardcache_t* shardcache_create </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="shardcache__node_8h.html#a860894af5414a0540d590e28afe950c7">shardcache_node_t</a> **&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespace_3global_scope_4.html#structshardcache__storage__t">shardcache_storage_t</a> *&#160;</td>
          <td class="paramname"><em>storage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_workers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_async</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>cache_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new shardcache instance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">me</td><td>A valid &lt;address:port&gt; null-terminated string representing the new node to be created </td></tr>
    <tr><td class="paramname">nodes</td><td>A list of &lt;address:port&gt; strings representing the nodes taking part to the shardcache 'cloud' </td></tr>
    <tr><td class="paramname">num_nodes</td><td>The number of nodes present in the nodes list </td></tr>
    <tr><td class="paramname">storage</td><td>A <a class="el" href="namespace_3global_scope_4.html#structshardcache__storage__t" title="Structure holding all the callback pointers required by shardcache to interact with underlying storag...">shardcache_storage_t</a> structure holding pointers to the storage callbacks.<br/>
 If NULL the internal (memory-only) volatile storage will be used for all the keys (and not only the ones being set with an expiration time) </td></tr>
    <tr><td class="paramname">secret</td><td>A null-terminated string containing the shared secret used to authenticate incoming messages </td></tr>
    <tr><td class="paramname">num_workers</td><td>The number of worker threads taking care of serving input connections </td></tr>
    <tr><td class="paramname">num_async</td><td>The number of async i/o threads handling the inter-node communication.<br/>
 If greater than 0 it will indicate the actual number of async-i/o threads to use.<br/>
 If smaller than 0 (negative) the number of async threads will be calculated in function of the number of num_workers (in the actual implemenation 1 extra async thread will be created every 20 workers.<br/>
 If 0 the default value (SHARDCACHE_ASYNC_THREADS_NUM_DEFAULT) will be used. </td></tr>
    <tr><td class="paramname">cache_size</td><td>The maximum size of the ARC cache </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a newly initialized shardcache descriptor</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The returned shardcache_t structure MUST be disposed using <a class="el" href="shardcache_8h.html#a25fc04bda4021be45e33cbcf4590e849" title="Release all the resources used by the shardcache instance.">shardcache_destroy()</a></dd>
<dd>
The newly created instance will copy all the pointers contained in the storage structure to its internal descriptor so the resources eventually allocated for the storage structure passed as argument can be safely released after calling <a class="el" href="shardcache_8h.html#a74346747eb9ad9da22cd1c6b06849d3e" title="Create a new shardcache instance.">shardcache_create()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a0c6344be0358998e1ba9809ba4f3fd4e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_use_persistent_connections </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>new_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af443e10682cbc1755ed4514d8a5708ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_evict_on_delete </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>new_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a450f19437f06b05ff8db556017d38394"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_force_caching </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>new_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4dfc8da5ca7b0d2ea2947db9b731a1fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_tcp_timeout </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>new_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab37e1067d136856d61a75ba3b32d6516"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_conn_expire_time </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>new_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac73a0c6f12b5b5f0c035967cdcf82727"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_iomux_run_timeout_low </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>new_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a32e1cc626c927a974cd574d98a3a9124"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_iomux_run_timeout_high </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>new_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad47c6ef316980ae82605b303c87e3c4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_expire_time </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>new_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aad3a553d54123b731207f95791f0022e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_serving_look_ahead </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>new_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a58997a3ef53dd994a9c495ff70a4e270"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_lazy_expiration </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>new_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a25fc04bda4021be45e33cbcf4590e849"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void shardcache_destroy </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Release all the resources used by the shardcache instance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>the instance to release </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="add7d8054738f5061aeb051b827596519"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* shardcache_get </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>vlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>timestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the value for a key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">vlen</td><td>If provided the length of the returned value will be stored at the location pointed by vlen </td></tr>
    <tr><td class="paramname">timestamp</td><td>If provided the timestamp of when the object was loaded into the cache will be stored at the specified address</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the stored value if any, NULL otherwise </dd></dl>
<dl class="section note"><dt>Note</dt><dd>the caller is responsible of releasing the memory of the returned value </dd></dl>

</div>
</div>
<a class="anchor" id="a871f29a62beca074def85a144d359ec2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t shardcache_head </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>head</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>hlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>timestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get partial value data value for a key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">head</td><td>A pointer to the memory where to store the partial data </td></tr>
    <tr><td class="paramname">hlen</td><td>The size of the memory pointed by 'head' </td></tr>
    <tr><td class="paramname">timestamp</td><td>If provided the timestamp of when the object was loaded into the cache will be stored at the specified address</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size copied in the 'head' pointer </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The returned size might be less than what specified in 'hlen' if the complete data is smaller than hlen </dd></dl>

</div>
</div>
<a class="anchor" id="aca9675ed9f8be9512d7e6151783168ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t shardcache_get_offset </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>olen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>timestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get partial value data value for a key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">out</td><td>A pointer to the memory where to store the partial data </td></tr>
    <tr><td class="paramname">olen</td><td>The size of the memory pointed by 'out' </td></tr>
    <tr><td class="paramname">offset</td><td>The offset from the beginning of the data we want to retrieve </td></tr>
    <tr><td class="paramname">timestamp</td><td>If provided the timestamp of when the object was loaded into the cache will be stored at the specified address</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size copied in the 'head' pointer </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The returned size might be less than what specified in 'hlen' if the complete data is smaller than hlen </dd></dl>

</div>
</div>
<a class="anchor" id="ae87bbf3da1b1a4b80f8c6213abc320ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_get_async </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="shardcache_8h.html#a3acf120b7116e8d820fc897eebc08db2">shardcache_get_async_callback_t</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>priv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the value for a key asynchronously. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">cb</td><td>The shardcache_get_async_callback_t which will be called for each received chunk </td></tr>
    <tr><td class="paramname">priv</td><td>A pointer which will be passed to the shardcache_get_async_callback_t at each call</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function might return immediately if the value for the requested key is already being downloaded (but not complete yet) In such a case The callback function will be called by the thread which is actually downloading the data hence the callback needs to be thread-safe.</dd>
<dd>
If the data requested is partially downloaded, the available data will be immediately passed to the callback and the rest will be passed while it's being downloaded. </dd></dl>

</div>
</div>
<a class="anchor" id="a41dee186c3b877f32386da245bcc6a7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_get_offset_async </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="shardcache_8h.html#a3acf120b7116e8d820fc897eebc08db2">shardcache_get_async_callback_t</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>priv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get partial value data value for a key asynchronously. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">offset</td><td>The offset from where to start retrieving data </td></tr>
    <tr><td class="paramname">length</td><td>The amount of data to fetch </td></tr>
    <tr><td class="paramname">cb</td><td>The shardcache_get_async_callback_t which will be called for each received chunk </td></tr>
    <tr><td class="paramname">priv</td><td>A pointer which will be passed to the shardcache_get_async_callback_t at each call</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function might return immediately if the value for the requested key is already being downloaded (but not complete yet) In such a case The callback function will be called by the thread which is actually downloading the data hence the callback needs to be thread-safe.</dd>
<dd>
If the data requested is partially downloaded, the available data will be immediately passed to the callback and the rest will be passed while it's being downloaded. </dd></dl>

</div>
</div>
<a class="anchor" id="a9eb52ab9f65460bdc4958eaefb0b2954"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_exists_async </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="shardcache_8h.html#a6c1c0f4fc9fde145696010fefaaee4c1">shardcache_async_response_callback_t</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>priv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if a specific key exists on the node responsible for it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">cb</td><td>The shardcache_async_response_callback_t which will be called once the response is completely retrieved </td></tr>
    <tr><td class="paramname">priv</td><td>A pointer which will be passed to the shardcache_async_response_callback_t when called </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if exists, 0 if doesn't exist, -1 in case of errors </dd></dl>

</div>
</div>
<a class="anchor" id="a55b425016e88f20934e14e338f795397"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_touch </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a key into the cache if not present already, otherwise update the loaded-timestamp. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successfully touched the item, -1 if it doesn't exists or in case of errors </dd></dl>

</div>
</div>
<a class="anchor" id="a671f35e550582e8e33f4d66ca03adc57"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_set </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>vlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the value for a key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">value</td><td>A valid pointer to the value </td></tr>
    <tr><td class="paramname">vlen</td><td>The length of the value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="shardcache_8h.html#a2aa7a564fbe7884299d77eca29432319" title="Set a volatile value for a key.">shardcache_set_volatile()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a7b16b6d50d4e163e92c44025f38ce581"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_set_async </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>vlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>expire</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>if_not_exists</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="shardcache_8h.html#a6c1c0f4fc9fde145696010fefaaee4c1">shardcache_async_response_callback_t</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>priv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the value for a key fetching the response asyncrhonously. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">value</td><td>A valid pointer to the value </td></tr>
    <tr><td class="paramname">vlen</td><td>The length of the value </td></tr>
    <tr><td class="paramname">expire</td><td>The number of seconds after which the volatile value expires If 0 the value will not expire and it will be stored using the actual storage module (which might evntually be a presistent storage backend as the filesystem or database ones) </td></tr>
    <tr><td class="paramname">if_not_exists</td><td>If this param is true, the value will be set only if there isn't one already stored </td></tr>
    <tr><td class="paramname">cb</td><td>The shardcache_async_response_callback_t which will be called once the result has been retreived </td></tr>
    <tr><td class="paramname">priv</td><td>A pointer which will be passed to the shardcache_async_response_callback_t when called </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="shardcache_8h.html#a2aa7a564fbe7884299d77eca29432319" title="Set a volatile value for a key.">shardcache_set_volatile()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a95760527edef026e88565106effe88b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_add </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>vlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the value for a key if it doesn't already exist. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">value</td><td>A valid pointer to the value </td></tr>
    <tr><td class="paramname">vlen</td><td>The length of the value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, 1 if the key already exists, -1 in case of error </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="shardcache_8h.html#a2aa7a564fbe7884299d77eca29432319" title="Set a volatile value for a key.">shardcache_set_volatile()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a2aa7a564fbe7884299d77eca29432319"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_set_volatile </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>vlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>expire</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a volatile value for a key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">value</td><td>A valid pointer to the value </td></tr>
    <tr><td class="paramname">vlen</td><td>The length of the value </td></tr>
    <tr><td class="paramname">expire</td><td>The number of seconds after which the volatile value expires If 0 the value will not expire and it will be stored using the actual storage module (which might evntually be a presistent storage backend as the filesystem or database ones) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="shardcache_8h.html#a671f35e550582e8e33f4d66ca03adc57" title="Set the value for a key.">shardcache_set()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="aa7c9051ef937c4b4ae02b0017d513274"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_add_volatile </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>vlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>expire</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the volatile value for a key if it doesn't already exist. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">value</td><td>A valid pointer to the value </td></tr>
    <tr><td class="paramname">vlen</td><td>The length of the value </td></tr>
    <tr><td class="paramname">expire</td><td>The number of seconds after which the volatile value expires If 0 the value will not expire and it will be stored using the actual storage module (which might evntually be a presistent storage backend as the filesystem or database ones) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, 1 if the key already exists, -1 in case of error </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="shardcache_8h.html#a2aa7a564fbe7884299d77eca29432319" title="Set a volatile value for a key.">shardcache_set_volatile()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="af859541766d97b6afb992ef1c843711a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_del </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove the value for a key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="shardcache_8h.html#a2aa7a564fbe7884299d77eca29432319" title="Set a volatile value for a key.">shardcache_set_volatile()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a49754acc649df6ffb5a997ddb924968d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_del_async </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="shardcache_8h.html#a6c1c0f4fc9fde145696010fefaaee4c1">shardcache_async_response_callback_t</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>priv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove the value for a key asynchronously. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">cb</td><td>The shardcache_async_response_callback_t which will be called once the result has been retreived </td></tr>
    <tr><td class="paramname">priv</td><td>A pointer which will be passed to the shardcache_async_response_callback_t when called </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="shardcache_8h.html#a2aa7a564fbe7884299d77eca29432319" title="Set a volatile value for a key.">shardcache_set_volatile()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="af3630c66ba810d5dad9bfbc2492f6cce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_evict </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove the value from the cache for a key. </p>
<dl class="section note"><dt>Note</dt><dd>the value will not be removed from the underlying storage </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="a7cac3c97e156092f9d560f54d37df98d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_test_ownership </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>klen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>owner</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the node owning a specific key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">key</td><td>A valid pointer to the key </td></tr>
    <tr><td class="paramname">klen</td><td>The length of the key </td></tr>
    <tr><td class="paramname">owner</td><td>If provided the pointed pointer will be set to the name (&lt;address:port&gt;) of the node owning the key </td></tr>
    <tr><td class="paramname">len</td><td>If not NULL, the size of the owner string will be stored in the memory pointed by 'len' </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if the current node (represented by cache) is the owner of the key, 0 otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="a9d02396238920c93777e1eb2bc83dad0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="shardcache__storage_8h.html#structshardcache__storage__index__t">shardcache_storage_index_t</a>* shardcache_get_index </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the index of keys managed by the specific shardcache instance by querying the storage module. </p>
<dl class="section return"><dt>Returns</dt><dd>A pointer to a <a class="el" href="shardcache__storage_8h.html#structshardcache__storage__index__t" title="structure representing the storage index, holding an array of shardcache_storage_index_item_t structu...">shardcache_storage_index_t</a> structure holding the index. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The caller MUST release the returned pointer once done with it by using the <a class="el" href="shardcache_8h.html#a7f3e042fe58a3dd7537c81de115bba25" title="Release all resources used by the index provided as argument.">shardcache_free_index()</a> function </dd></dl>

</div>
</div>
<a class="anchor" id="a7f3e042fe58a3dd7537c81de115bba25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void shardcache_free_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="shardcache__storage_8h.html#structshardcache__storage__index__t">shardcache_storage_index_t</a> *&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Release all resources used by the index provided as argument. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>A pointer to a valid <a class="el" href="shardcache__storage_8h.html#structshardcache__storage__index__t" title="structure representing the storage index, holding an array of shardcache_storage_index_item_t structu...">shardcache_storage_index_t</a> structure previously obtained via the <a class="el" href="shardcache_8h.html#a9d02396238920c93777e1eb2bc83dad0" title="Get the index of keys managed by the specific shardcache instance by querying the storage module...">shardcache_get_index()</a> function </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab9e3022be060e7b5e67af43c682632ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_migration_begin </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="shardcache__node_8h.html#a860894af5414a0540d590e28afe950c7">shardcache_node_t</a> **&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>forward</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start a migration process. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
    <tr><td class="paramname">nodes</td><td>The list of nodes representing the new group to migrate to </td></tr>
    <tr><td class="paramname">num_nodes</td><td>The number of nodes in the list </td></tr>
    <tr><td class="paramname">forward</td><td>A boolean flag indicating if the migration command needs to be forwarded to all other peers </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="a719c3343ec7ac158d71d6f286da5fec9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_migration_abort </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Abort the current migration process. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 in case of errors (for instance if no migration is in progress when this function is called) </dd></dl>

</div>
</div>
<a class="anchor" id="a767a80d75a850f38c60c298cffe180fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int shardcache_migration_end </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>End the current migration process by swapping the two continua and releasing resources for the old one. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>A valid pointer to a shardcache_t structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 in case of errors (for instance if no migration is in progress when this function is called) </dd></dl>

</div>
</div>
<a class="anchor" id="a36c2f67d3e4dd28ba7d932b022e39985"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void shardcache_thread_init </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Notify the internal shardcache core about a new woerker thread which might access the API. This function must be called early within each user-created thread (which is intended to access the shardcache API at some stage during its lifespan) to initialize thread-specific variables. </p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="shardcache_8h.html#abf5bf17736aec39c86103020721c12cc" title="Release the resources allocated by shardcache_thread_init() This function needs to be called before c...">shardcache_thread_end()</a> MUST be esplicitly called before the background thread exits to avoid memory leakage. </dd></dl>

</div>
</div>
<a class="anchor" id="abf5bf17736aec39c86103020721c12cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void shardcache_thread_end </td>
          <td>(</td>
          <td class="paramtype">shardcache_t *&#160;</td>
          <td class="paramname"><em>cache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Release the resources allocated by <a class="el" href="shardcache_8h.html#a36c2f67d3e4dd28ba7d932b022e39985" title="Notify the internal shardcache core about a new woerker thread which might access the API...">shardcache_thread_init()</a> This function needs to be called before calling pthread_exit() to free memory allocated by <a class="el" href="shardcache_8h.html#a36c2f67d3e4dd28ba7d932b022e39985" title="Notify the internal shardcache core about a new woerker thread which might access the API...">shardcache_thread_init()</a>. </p>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="shardcache_8h.html#abf5bf17736aec39c86103020721c12cc" title="Release the resources allocated by shardcache_thread_init() This function needs to be called before c...">shardcache_thread_end()</a> is not invoked automatically by the client library. It must be called explicitly to avoid a memory leak. </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a212ce745de022f9dab442d5232cc1809"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* LIBSHARDCACHE_VERSION</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="shardcache_8h.html">shardcache.h</a></li>
    <li class="footer">Generated on Thu Sep 11 2014 16:37:01 for libshardcache by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
